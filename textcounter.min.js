/*!
* jQuery Text Counter Plugin v0.2.0
* https://github.com/ractoon/jQuery-Text-Counter
*
* Copyright 2013 ractoon
* Released under the MIT license
*/
;(function($){$.textcounter=function(el,options){var base=this;base.$el=$(el);base.el=el;base.$el.data("textcounter",base);base.init=function(){base.options=$.extend({},$.textcounter.defaultOptions,options);var textcountID=base.$el.attr("id")+"-textcount",counterText=base.options.countDown?base.options.countDownText:base.options.counterText,counterNum=base.options.countDown?base.options.max:0;base.$el.after("<"+base.options.countContainerElement+' class="'+base.options.countContainerClass+'">'+counterText+'<span class="text-count">'+counterNum+"</span></"+base.options.countContainerElement+">");base.$el.bind("keyup.textcounter click.textcounter blur.textcounter focus.textcounter change.textcounter paste.textcounter",base.checkLimits).trigger("click.textcounter")};base.checkLimits=function(e){var $this=base.$el,$countEl=$this.siblings("."+base.options.countContainerClass),$text=$this.val(),textCount=0,textTotalCount=0,eventTriggered=e.originalEvent===undefined?false:true;if(base.options.type=="word"){textCount=$text.replace(/\s+/g," ").split(" ").length;if($this.val()===""){textCount=0}}else{if(base.options.countSpaces){textCount=$text.length}else{textCount=$text.replace(/\s/g,"").length}if(base.options.countExtendedCharacters){var extended=$text.match(/[^\x00-\xff]/gi);if(extended==null){textCount=$text.length}else{textCount=$text.length+extended.length}}}textTotalCount=base.options.countDown?base.options.max-textCount:textCount;base.setCount(textTotalCount);if(base.options.min>0&&eventTriggered){if(textCount<base.options.min){base.setErrors("min")}else{if(textCount>=base.options.min){base.clearErrors("min")}}}if(base.options.max!==-1){if(textCount>base.options.max&&base.options.max!=0){if(base.options.stopInputAtMaximum){var trimmedString="";if(base.options.type=="word"){var wordArray=$text.split(/[\s\.\?]+/);for(var i=0;i<base.options.max;i++){trimmedString+=wordArray[i]+" "}}else{if(base.options.countSpaces){trimmedString=$text.substring(0,base.options.max)}else{var charArray=$text.split(""),totalCharacters=charArray.length,charCount=0,i=0;while(charCount<base.options.max&&i<totalCharacters){if(charArray[i]!==" "){charCount++}trimmedString+=charArray[i++]}}}$this.val(trimmedString);textTotalCount=base.options.countDown?0:base.options.max;base.setCount(textTotalCount)}else{base.setErrors("max")}}else{base.clearErrors("max")}}};base.setCount=function(count){var $this=base.$el,$countEl=$this.siblings("."+base.options.countContainerClass);$countEl.children(".text-count").text(count)};base.setErrors=function(type){var $this=base.$el,$countEl=$this.siblings("."+base.options.countContainerClass);$this.addClass(base.options.inputErrorClass);$countEl.addClass(base.options.counterErrorClass);if(base.options.displayErrorText){switch(type){case"min":errorText=base.options.minimumErrorText;break;case"max":errorText=base.options.maximumErrorText;break}if(!$countEl.children(".error-text-"+type).length){$countEl.append("<"+base.options.errorTextElement+' class="error-text error-text-'+type+'">'+errorText+"</"+base.options.errorTextElement+">")}}};base.clearErrors=function(type){var $this=base.$el,$countEl=$this.siblings("."+base.options.countContainerClass);$countEl.children(".error-text-"+type).remove();if($countEl.children(".error-text").length==0){$this.removeClass(base.options.inputErrorClass);$countEl.removeClass(base.options.counterErrorClass)}};base.init()};$.textcounter.defaultOptions={type:"character",min:0,max:200,countContainerElement:"div",countContainerClass:"text-count-wrapper",inputErrorClass:"error",counterErrorClass:"error",counterText:"Total Count: ",errorTextElement:"div",minimumErrorText:"Minimum not met",maximumErrorText:"Maximum exceeded",displayErrorText:true,stopInputAtMaximum:true,countSpaces:false,countDown:false,countDownText:"Remaining: ",countExtendedCharacters:false};$.fn.textcounter=function(options){return this.each(function(){new $.textcounter(this,options)})}})(jQuery);